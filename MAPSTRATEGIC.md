# MAPSTRATEGIC: Knowledge Extractor

> Стратегическая карта развития KE (DP.AISYS.013).
> Владелец: разработчик KE. Читатель: Стратег (session-prep → агрегация в Strategy.md).

---

## Phase 0: MVP (текущая) ✅

**Что есть:** 7 промптов, PROCESSES.md, автоматизация (launchd inbox-check 3h), TG уведомления, config/routing.md, config/feedback-log.md.

**Результат:** Inbox-check работает headless. Остальные 6 процессов — готовы к тесту.

**Метрики:** время inbox-check ~1.5 мин, 1 тестовый прогон (defer).

---

## Phase 0.5: Обучаемость + точность (next)

> Цель: KE точнее классифицирует, меньше defer/reject. Новый Claude быстрее понимает KE.

| Действие | Файл | Эффект |
|----------|------|--------|
| Эталонные экстракции (3-5 примеров input → output) | `config/examples.md` | KE видит «как правильно» |
| Дерево решений (capture → тип → Pack → директория) | `config/decision-tree.md` | Снижает ошибки маршрутизации |
| Шаблоны по типам (из session-close.md) | `config/templates.md` | Единый источник для всех промптов |
| Confidence scoring (high/medium/low) | Обновление промптов | Пользователь фокусируется на low-confidence |
| Накопление паттернов в feedback-log.md | Автоматически | После 10+ записей → обобщить в антипаттерны |

**Критерий перехода:** accept rate >70% на 10+ captures, feedback-log.md содержит ≥5 записей.

---

## Phase 1: Полное покрытие сценариев

> Цель: все 7 процессов протестированы и работают. Headless audit + inbox-check по расписанию.

| Действие | Эффект |
|----------|--------|
| Протестировать session-close (в рамках Protocol Close) | Основной поток экстракции работает |
| Протестировать knowledge-audit (headless, раз в неделю) | Проактивное обнаружение пробелов в Pack |
| Протестировать cross-repo-sync (при изменении Pack) | Downstream актуален |
| Протестировать ontology-sync | Онтологии синхронизированы |
| launchd: audit (еженедельно, Пн 02:00) | Второй headless процесс |

**Критерий перехода:** 7/7 статусов = «Работает».

---

## Phase 2: Метрики и калибровка

> Цель: объективная оценка качества KE. Регрессионное тестирование.

| Действие | Эффект |
|----------|--------|
| Калибровочный набор (5 captures + ожидаемый результат) | Регрессионный тест |
| Метрики за неделю (accept/reject/defer ratio) | Тренд качества |
| Partitioned audit (1 Pack за запуск) | Умещается в контекст |
| Приоритизация captures (urgent/routine) | Важное обрабатывается первым |

**Критерий перехода:** метрики собираются автоматически, accept rate стабильно >70%.

---

## Phase 3: Генеративность (горизонт)

> Цель: KE обнаруживает знание проактивно, а не только из captures.

| Действие | Эффект |
|----------|--------|
| Auto-capture из git diff (pre-commit hook) | KE находит знание в коммитах |
| Новые типы знаний (principle, pattern, recipe) | Расширенный bounded context |
| Knowledge graph (связи между сущностями) | Навигация, обнаружение пробелов |
| Incremental ontology sync (diff-based) | Масштабируемая синхронизация |

**Критерий перехода:** KE предлагает captures без ручного ввода.

---

## Риски

| Риск | Вероятность | Митигация |
|------|-------------|-----------|
| Контекст Claude переполняется при многих Pack | Средняя | Lazy reading + batching (уже есть) |
| Низкий accept rate → пользователь перестаёт проверять | Средняя | Feedback-log + калибровка |
| Новый Pack без обновления routing.md | Низкая | Audit проверяет routing.md vs реальные Pack |

---

*Обновлено: 2026-02-12*
